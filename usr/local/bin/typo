#!/usr/bin/picolisp /usr/local/lib/shell.l
(fexec "sed" "-r" "
	s/( [а-з1-9]\\)) /\\1 /g
	s/(([\^А-ЯIЇЄҐЁа-яiїєґё,] |[\^А-ЯIЇЄҐЁа-яiїєґё-]|\^)([А-ЯIЁ]|Ах|Ох|Ух|Уж|Во|До|Но|По|Со|То|Да|За|На|Из|От|Об|Ну)) /\\1 /g
	s/[  ][—-] / — /g
	s/(<p[\^>]*>|\^)[—-][  ]/\\1— /g
	s/[  ][—–-](<\\/(p|v)>)/ —\\1/g
	s/((<p( [\^>]*)?>(<[\^/>]+>)*|\^)—)[  ]/\\1 /g
	s/(([\^а-яiїєґёА-ЯIЇЄҐЁ0-9-]|\^)[авикосуійз]) ([«„а-яА-ЯЁё0-9a-zA-Z<])/\\1 \\3/g
	s/(([\^а-яiїєґёА-ЯIЇЄҐЁ0-9-]|\^)[АВИКОСУІЙЗ]) ([«„А-ЯЁ0-9A-Z<])/\\1 \\3/g
	s/((\\(|[,:;…] |—[   ])я) /\\1 /g
	s/(\\([а-яiїєґё][а-яiїєґё]) /\\1 /Ig
	s/(([\^а-яiїєґё]|\^)н[еи]) /\\1 /Ig
	s/([а-яiїєґё]) ((б[ыи]?|л[иь]|же?)[\^а-яiїєґё-])/\\1 \\2/g
	s/( (де|ван)) ([А-ЯIЇЄҐЁ])/\\1 \\3/g
	s/([ >][ЯИОА],) /\\1 /g
	s/(\\([иая],) /\\1 /Ig
	s/([\\(«„]я) /\\1 /g
	s/([0-9][0-9]([0-9][0-9])?) (год[ауео]?)/\\1 \\3/g
	s/([0-9][0-9]?) ((января|февраля|марта|апреля|мая|июня|июля|августа|сентября|октября|ноября|декабря)[\^а-яё])/\\1 \\2/g
	s/([0-9,]*[0-9]) ([лг]\\.|гг\\.|(лет|раз|года?|человек|м)[\^а-яё]|тыс|гц|мм|мк|км|миль|млн|млрд|процент|час|минут|секунд|кг|тонн|грамм|гр\\.|рубл|копе|метр|кило|милли|санти|долл)/\\1 \\2/Ig
	s/([\^а-яё]глав[аe]) ([0-9])/\\1 \\2/Ig
	s/(<p[\^>]*>[а-яiїєґё0-9][\\).]) /\\1 /Ig
	s/([а-яё]) (я[.!?…“»:;])/\\1 \\2/g
	s/([0-9]) (000[\^0-9])/\\1 \\2/g
	s/([\^.])\\.\\.\\.([\^.])/\\1…\\2/g
	s/((<p[\^>]*>(—\\s)?|\\. )[А-ЯIЇЄҐЁ],) /\\1 /g
	s/ («?[а-яiїєґё][а-яiїєґё]?[.!?…“»:;]*<\\/([pv]|subtitle|text-author)>)/ \\1/Ig
	s/(№)[      ]*([\^№])/\\1 \\2/g
	s/([\^0-9][1-2][0-9]{3})-([1-2][0-9]{3}[\^0-9])/\\1—\\2/g
	s/([а-яiїєґё]) ([а-яiїєґё0-9]([“»]|[\\)][\^   ]))/\\1 \\2/Ig
	s/([\^а-яё]л\\.) (с\\.)/\\1 \\2/g
	s/([\^а-яё]н\\.) (э\\.)/\\1 \\2/g
	s/(,) (а\\?)/\\1 \\2/g
")